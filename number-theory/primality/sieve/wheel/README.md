# Wheel factorization
[Wheel factorization](https://en.wikipedia.org/wiki/Wheel_factorization) is a
method of finding prime numbers up to a given limit. More details can be found
in the following paper:
Paul Pritchard  
[Explaining the wheel sieve](https://dx.doi.org/10.1007/BF00264164)

## Implementation details
Wheel factorization removes all integers that are not relatively prime
to the given `wheel_primes`.
For example, if the `wheel_primes[] = {2}`, then all even numbers will be
ignores.  
For each integer `x` that are relatively prime to the given `wheel_primes`,
`WheelIndex(x)` will be the index of the integer in the bitset.
For example, if `wheel_primes[] = {2}`, then `WheelIndex(x) = (x - 2) / 2`.  

In order to compute the `WheelIndex`, we need following definitions:
1. `primorial`: the product of all `wheel_primes`.
1. `number_of_coprimes`: the number of integers that are relatively prime to all 
`wheel_primes`.
1. `coprimes`: the array of all integers that are smaller than primorial and
relatively prime to `wheel_primes`.
1. `coprime_indices`: an array of length `primorial`, where
`coprime_indices[i]` is the number of integers that are less than `x` and 
are relatively prime to `wheel_primes`.  

For example, if `wheel_primes[] = {2, 3}`, then
`coprime_indices[] = {0, 0, 1, 1, 1, 1}`.  
For an integer `x = q * primorial + m` that is relatively prime to
`wheel_primes`, where `m = q % primorial`, `x`'s `wheel_index` will be
`q * number_of_coprimes + coprime_indices[m]`.
Thus, we usually consider `x` as a pair `(q, coprime_indices[m])`, where
`m = q % primorial`, and `coprime_indices[m]` is usually called `step_index` of
`x` in the program.

During the process of sieve, we need to find the integer `y` corresponding
to the index of `WheelIndex(x) + 1`.  That is, the integer `y` corresponding
to the index of `WheelIndex(x) + 1` is either `(q, coprime_indices[m] + 1)`
if `coprime_indices[m] + 1 < number_of_coprimes` or `(q + 1, 0)`.
Thus, `y - x` is just the diference of the coprimes indexed by the
`coprime_indices`.
Hence, we can store the difference from the coprimes to the next coprimes in
a `steps` array.
For example, if `wheel_primes[] = {2, 3}`, then `steps[] = {4, 2}`, since
only integers in the form of `6k + 1` and `6k - 1` are considered.
Using the `steps` array, `y = x + steps[NextStepIndex(coprime_indices[m])]`.

During the process of sieve, we also need the following operation:
Given the index of integer `j * k`, where both `j` and `k` are relatively prime
 to `wheel_primes` find the index of `j * h`, where the index of `h` is
`WheelIndex(k) + 1`.
Let `x = j * k`, `j` is represented by `(q_j, coprime_indices[m_j])`,
and `k` is represented by `(q_k, coprime_indices[m_k])`, then the index of
`j * h` will be `(q_j / primorial) * base_increment[coprime_indices[m_k]] +
increments[coprime_indices[m_j]][coprime_indices[m_k]]`
The tables of `base_increment` and `increments` can be generated by `Precompute`.
The idea of computing `base_increment` and `increments` is as follows: Let
`j = primorial * q_j + m_j`, `k = primorial * q_k + m_k`. Since `h - k = steps[m_k]`,
`j * (h - k) = primorial * q_j * steps[m_k] + m_j * steps[m_k]`.
Thus, we use `base_increment[i] = WheelIndex(primorial * steps[i])`.
We set `increments[coprime_indices[a]][coprime_indices[b]]` to be
the increment of index from `a * b` to `a * (b + steps[b])`, for all `a` and `b`
in `coprimes`.

## Benchmark
When the bitset is not used, wheel sieve is not faster than segmented sieve.
When the bitset is used, wheel sieve is faster than segmented sieve. 
Moreover, 30-sieve is faster than 210-sieve, and 210-sieve is faster than
6-sieve.

<pre>
---------------------------------------------------------------------------------
Benchmark                                          Time            CPU Iterations
---------------------------------------------------------------------------------
BM_SegmentedSieve/1024                           465 ns         465 ns   30244480
BM_SegmentedSieve/2048                           789 ns         789 ns   17738749
BM_SegmentedSieve/4096                          1504 ns        1504 ns    9315888
BM_SegmentedSieve/8192                          2975 ns        2975 ns    4653055
BM_SegmentedSieve/16384                         6057 ns        6057 ns    2342606
BM_SegmentedSieve/32768                        11742 ns       11743 ns    1206908
BM_SegmentedSieve/65536                        24090 ns       24090 ns     597487
BM_SegmentedSieve/131072                       47073 ns       47073 ns     300272
BM_SegmentedSieve/262144                       96514 ns       96515 ns     133826
BM_SegmentedSieve/524288                      198342 ns      198344 ns      71186
BM_SegmentedSieve/1048576                     410597 ns      410601 ns      33886
BM_SegmentedSieve/2097152                     878850 ns      878859 ns      16175
BM_SegmentedSieve/4194304                    1804616 ns     1804635 ns       7164
BM_SegmentedSieve/8388608                    3717989 ns     3718020 ns       3799
BM_SegmentedSieve/16777216                   7772829 ns     7772882 ns       1818
BM_SegmentedSieve/33554432                  16452401 ns    16452535 ns        864
BM_SegmentedSieve/67108864                  34776644 ns    34776816 ns        416
BM_SegmentedSieve/134217728                 72271781 ns    72272197 ns        199
BM_SegmentedSieve/268435456                148203598 ns   148204715 ns         95
BM_SegmentedSieve/536870912                322752293 ns   322754630 ns         45
BM_SegmentedSieve/1073741824               663615186 ns   663618687 ns         21
BM_WheelSieve6/1024                              155 ns         155 ns   92640304
BM_WheelSieve6/2048                              376 ns         376 ns   37237449
BM_WheelSieve6/4096                              792 ns         792 ns   17602216
BM_WheelSieve6/8192                             1727 ns        1727 ns    8133448
BM_WheelSieve6/16384                            3534 ns        3534 ns    3960817
BM_WheelSieve6/32768                            7282 ns        7283 ns    1917398
BM_WheelSieve6/65536                           15191 ns       15191 ns     920614
BM_WheelSieve6/131072                          37052 ns       37052 ns     378597
BM_WheelSieve6/262144                          79374 ns       79373 ns     176256
BM_WheelSieve6/524288                         163141 ns      163140 ns      85819
BM_WheelSieve6/1048576                        405307 ns      405308 ns      34513
BM_WheelSieve6/2097152                       1027196 ns     1027199 ns      13602
BM_WheelSieve6/4194304                       2130742 ns     2130748 ns       6572
BM_WheelSieve6/8388608                       4422906 ns     4422914 ns       3161
BM_WheelSieve6/16777216                      9292269 ns     9292293 ns       1506
BM_WheelSieve6/33554432                     31696784 ns    31696762 ns        441
BM_WheelSieve6/67108864                    105706469 ns   105704752 ns        133
BM_WheelSieve6/134217728                   250237127 ns   250234012 ns         56
BM_WheelSieve6/268435456                   547516816 ns   547489050 ns         26
BM_WheelSieve6/536870912                  1167221219 ns  1167204840 ns         12
BM_WheelSieve6/1073741824                 2454635921 ns  2454605650 ns          6
BM_WheelSieve30/1024                             121 ns         121 ns  115911216
BM_WheelSieve30/2048                             264 ns         264 ns   53700345
BM_WheelSieve30/4096                             566 ns         566 ns   24883707
BM_WheelSieve30/8192                            1265 ns        1265 ns   11271456
BM_WheelSieve30/16384                           2479 ns        2479 ns    5669878
BM_WheelSieve30/32768                           5015 ns        5015 ns    2795216
BM_WheelSieve30/65536                          10464 ns       10464 ns    1339124
BM_WheelSieve30/131072                         22277 ns       22277 ns     628617
BM_WheelSieve30/262144                         57706 ns       57706 ns     244963
BM_WheelSieve30/524288                        115511 ns      115511 ns     121462
BM_WheelSieve30/1048576                       248556 ns      248556 ns      56421
BM_WheelSieve30/2097152                       734295 ns      734296 ns      19065
BM_WheelSieve30/4194304                      1610647 ns     1610645 ns       8689
BM_WheelSieve30/8388608                      3363602 ns     3363606 ns       4160
BM_WheelSieve30/16777216                     7043545 ns     7043537 ns       1984
BM_WheelSieve30/33554432                    17595867 ns    17595837 ns        789
BM_WheelSieve30/67108864                    77098890 ns    77098647 ns        182
BM_WheelSieve30/134217728                  192048234 ns   192048135 ns         73
BM_WheelSieve30/268435456                  429127360 ns   429126034 ns         33
BM_WheelSieve30/536870912                  920993145 ns   920991954 ns         15
BM_WheelSieve30/1073741824                1944001920 ns  1943996511 ns          7
BM_WheelSieve210/1024                            207 ns         207 ns   67520336
BM_WheelSieve210/2048                            478 ns         478 ns   29319968
BM_WheelSieve210/4096                           1147 ns        1147 ns   11971949
BM_WheelSieve210/8192                           2574 ns        2574 ns    5434342
BM_WheelSieve210/16384                          5740 ns        5740 ns    2454101
BM_WheelSieve210/32768                         12704 ns       12704 ns    1103862
BM_WheelSieve210/65536                         27567 ns       27567 ns     508141
BM_WheelSieve210/131072                        59595 ns       59595 ns     235276
BM_WheelSieve210/262144                       127205 ns      127205 ns     109184
BM_WheelSieve210/524288                       269781 ns      269782 ns      51863
BM_WheelSieve210/1048576                      569078 ns      569077 ns      24608
BM_WheelSieve210/2097152                     1197757 ns     1197756 ns      11692
BM_WheelSieve210/4194304                     2507040 ns     2507041 ns       5586
BM_WheelSieve210/8388608                     5227128 ns     5227124 ns       2677
BM_WheelSieve210/16777216                   10915411 ns    10915376 ns       1280
BM_WheelSieve210/33554432                   22778170 ns    22778161 ns        613
BM_WheelSieve210/67108864                   67243514 ns    67242170 ns        208
BM_WheelSieve210/134217728                 172400956 ns   172389288 ns         81
BM_WheelSieve210/268435456                 387186637 ns   387161048 ns         36
BM_WheelSieve210/536870912                 829045751 ns   828991869 ns         17
BM_WheelSieve210/1073741824               1851950972 ns  1851842156 ns          8
BM_SegmentedWheelSieve6/1024                     431 ns         430 ns   32648782
BM_SegmentedWheelSieve6/2048                     795 ns         795 ns   17512340
BM_SegmentedWheelSieve6/4096                    1485 ns        1485 ns    9434848
BM_SegmentedWheelSieve6/8192                    2774 ns        2774 ns    5047538
BM_SegmentedWheelSieve6/16384                   5981 ns        5981 ns    2340491
BM_SegmentedWheelSieve6/32768                  11479 ns       11479 ns    1220937
BM_SegmentedWheelSieve6/65536                  22409 ns       22408 ns     624786
BM_SegmentedWheelSieve6/131072                 45526 ns       45524 ns     307484
BM_SegmentedWheelSieve6/262144                 95096 ns       95092 ns     147242
BM_SegmentedWheelSieve6/524288                198548 ns      198540 ns      70597
BM_SegmentedWheelSieve6/1048576               418140 ns      418122 ns      33528
BM_SegmentedWheelSieve6/2097152               890663 ns      890626 ns      15717
BM_SegmentedWheelSieve6/4194304              1885560 ns     1885486 ns       7427
BM_SegmentedWheelSieve6/8388608              3999715 ns     3999566 ns       3501
BM_SegmentedWheelSieve6/16777216             8554100 ns     8553776 ns       1637
BM_SegmentedWheelSieve6/33554432            18593469 ns    18592767 ns        754
BM_SegmentedWheelSieve6/67108864            39940735 ns    39939226 ns        351
BM_SegmentedWheelSieve6/134217728           87278874 ns    87275880 ns        161
BM_SegmentedWheelSieve6/268435456          190457128 ns   190450789 ns         74
BM_SegmentedWheelSieve6/536870912          419333576 ns   419320170 ns         33
BM_SegmentedWheelSieve6/1073741824         936157227 ns   936126628 ns         15
BM_SegmentedWheelSieve30/1024                    295 ns         295 ns   47389476
BM_SegmentedWheelSieve30/2048                    560 ns         560 ns   25205550
BM_SegmentedWheelSieve30/4096                   1011 ns        1011 ns   13853262
BM_SegmentedWheelSieve30/8192                   1961 ns        1961 ns    7135080
BM_SegmentedWheelSieve30/16384                  3699 ns        3699 ns    3786616
BM_SegmentedWheelSieve30/32768                  7378 ns        7378 ns    1898363
BM_SegmentedWheelSieve30/65536                 14896 ns       14896 ns     940149
BM_SegmentedWheelSieve30/131072                31007 ns       31006 ns     451837
BM_SegmentedWheelSieve30/262144                66227 ns       66225 ns     211448
BM_SegmentedWheelSieve30/524288               139220 ns      139217 ns      99918
BM_SegmentedWheelSieve30/1048576              295395 ns      295388 ns      47398
BM_SegmentedWheelSieve30/2097152              632873 ns      632858 ns      22127
BM_SegmentedWheelSieve30/4194304             1365043 ns     1365011 ns      10262
BM_SegmentedWheelSieve30/8388608             2949743 ns     2949674 ns       4748
BM_SegmentedWheelSieve30/16777216            6476540 ns     6476396 ns       2161
BM_SegmentedWheelSieve30/33554432           14472936 ns    14472594 ns        968
BM_SegmentedWheelSieve30/67108864           32598389 ns    32597641 ns        430
BM_SegmentedWheelSieve30/134217728          72880272 ns    72878354 ns        192
BM_SegmentedWheelSieve30/268435456         162923829 ns   162919436 ns         86
BM_SegmentedWheelSieve30/536870912         365090782 ns   365083933 ns         38
BM_SegmentedWheelSieve30/1073741824        821270853 ns   821256097 ns         17
BM_SegmentedWheelSieve210/1024                   382 ns         382 ns   36683333
BM_SegmentedWheelSieve210/2048                   752 ns         752 ns   18624351
BM_SegmentedWheelSieve210/4096                  1776 ns        1776 ns    7894841
BM_SegmentedWheelSieve210/8192                  3666 ns        3665 ns    3817964
BM_SegmentedWheelSieve210/16384                 7575 ns        7575 ns    1848577
BM_SegmentedWheelSieve210/32768                16140 ns       16139 ns     867124
BM_SegmentedWheelSieve210/65536                33342 ns       33342 ns     419936
BM_SegmentedWheelSieve210/131072               69755 ns       69754 ns     200391
BM_SegmentedWheelSieve210/262144              145743 ns      145741 ns      96259
BM_SegmentedWheelSieve210/524288              307236 ns      307231 ns      45599
BM_SegmentedWheelSieve210/1048576             648017 ns      648006 ns      21594
BM_SegmentedWheelSieve210/2097152            1384795 ns     1384774 ns      10107
BM_SegmentedWheelSieve210/4194304            2911761 ns     2911713 ns       4807
BM_SegmentedWheelSieve210/8388608            6297631 ns     6297526 ns       2272
BM_SegmentedWheelSieve210/16777216          13073929 ns    13073741 ns       1069
BM_SegmentedWheelSieve210/33554432          27973730 ns    27973240 ns        501
BM_SegmentedWheelSieve210/67108864          59887220 ns    59886269 ns        234
BM_SegmentedWheelSieve210/134217728        128355169 ns   128353388 ns        109
BM_SegmentedWheelSieve210/268435456        275226143 ns   275222379 ns         51
BM_SegmentedWheelSieve210/536870912        594046005 ns   594037743 ns         24
BM_SegmentedWheelSieve210/1073741824      1287430333 ns  1287413047 ns         11
BM_SegmentedSieveBitset/1                        696 ns         696 ns   20110314
BM_SegmentedSieveBitset/2                       1258 ns        1258 ns   11114663
BM_SegmentedSieveBitset/4                       2457 ns        2457 ns    5700422
BM_SegmentedSieveBitset/8                       4848 ns        4847 ns    2888476
BM_SegmentedSieveBitset/16                      9702 ns        9702 ns    1442727
BM_SegmentedSieveBitset/32                     19859 ns       19859 ns     704896
BM_SegmentedSieveBitset/64                     40464 ns       40463 ns     345970
BM_SegmentedSieveBitset/128                    83278 ns       83277 ns     168097
BM_SegmentedSieveBitset/256                   171545 ns      171543 ns      81305
BM_SegmentedSieveBitset/512                   352547 ns      352543 ns      39708
BM_SegmentedSieveBitset/1024                  733886 ns      733877 ns      19076
BM_SegmentedSieveBitset/2048                 1526456 ns     1526438 ns       9172
BM_SegmentedSieveBitset/4096                 3292687 ns     3292644 ns       4257
BM_SegmentedSieveBitset/8192                 7359680 ns     7359600 ns       1902
BM_SegmentedSieveBitset/16384               14977840 ns    14977657 ns        935
BM_SegmentedSieveBitset/32768               30634071 ns    30633712 ns        456
BM_SegmentedSieveBitset/65536               62938090 ns    62937304 ns        223
BM_SegmentedSieveBitset/131072             129163585 ns   129162142 ns        108
BM_SegmentedSieveBitset/262144             264600705 ns   264598014 ns         53
BM_SegmentedSieveBitset/524288             541933605 ns   541926909 ns         26
BM_SegmentedSieveBitset/1048576           1107150463 ns  1107138124 ns         13
BM_SegmentedSieveBitset/2097152           2257427472 ns  2257298761 ns          6
BM_SegmentedSieveBitset/4194304           4598774512 ns  4598431658 ns          3
BM_SegmentedSieveBitset/8388608           9362655071 ns  9361960346 ns          2
BM_SegmentedSieveBitset/16777216         19071687835 ns 19070428766 ns          1
BM_WheelSieve6Bitset/1                           263 ns         263 ns   52362055
BM_WheelSieve6Bitset/2                           628 ns         628 ns   22287087
BM_WheelSieve6Bitset/4                          1323 ns        1323 ns   10567319
BM_WheelSieve6Bitset/8                          2924 ns        2924 ns    4777605
BM_WheelSieve6Bitset/16                         6215 ns        6215 ns    2251663
BM_WheelSieve6Bitset/32                        13261 ns       13261 ns    1054161
BM_WheelSieve6Bitset/64                        28042 ns       28042 ns     498943
BM_WheelSieve6Bitset/128                       59117 ns       59116 ns     236879
BM_WheelSieve6Bitset/256                      124067 ns      124065 ns     112900
BM_WheelSieve6Bitset/512                      259392 ns      259389 ns      53994
BM_WheelSieve6Bitset/1024                     541521 ns      541515 ns      25848
BM_WheelSieve6Bitset/2048                    1129193 ns     1129183 ns      12404
BM_WheelSieve6Bitset/4096                    2339594 ns     2339570 ns       5967
BM_WheelSieve6Bitset/8192                    4954040 ns     4953997 ns       2829
BM_WheelSieve6Bitset/16384                  10700620 ns    10700520 ns       1309
BM_WheelSieve6Bitset/32768                  22453339 ns    22453148 ns        623
BM_WheelSieve6Bitset/65536                  46612737 ns    46612305 ns        300
BM_WheelSieve6Bitset/131072                 96506308 ns    96505396 ns        145
BM_WheelSieve6Bitset/262144                324641645 ns   324636024 ns         43
BM_WheelSieve6Bitset/524288                829925199 ns   829908028 ns         17
BM_WheelSieve6Bitset/1048576              1882234951 ns  1882184472 ns          7
BM_WheelSieve6Bitset/2097152              4061555558 ns  4061478916 ns          3
BM_WheelSieve6Bitset/4194304              8570601478 ns  8570423184 ns          2
BM_WheelSieve6Bitset/8388608             18008150725 ns 18007808922 ns          1
BM_WheelSieve6Bitset/16777216            37665044433 ns 37664347118 ns          1
BM_WheelSieve30Bitset/1                          173 ns         173 ns   80011222
BM_WheelSieve30Bitset/2                          376 ns         376 ns   37344366
BM_WheelSieve30Bitset/4                          866 ns         866 ns   16219982
BM_WheelSieve30Bitset/8                         1892 ns        1892 ns    7406325
BM_WheelSieve30Bitset/16                        4048 ns        4048 ns    3462007
BM_WheelSieve30Bitset/32                        8553 ns        8552 ns    1637045
BM_WheelSieve30Bitset/64                       18429 ns       18429 ns     759275
BM_WheelSieve30Bitset/128                      39109 ns       39108 ns     358028
BM_WheelSieve30Bitset/256                      82796 ns       82794 ns     169111
BM_WheelSieve30Bitset/512                     174373 ns      174371 ns      80343
BM_WheelSieve30Bitset/1024                    366535 ns      366530 ns      38193
BM_WheelSieve30Bitset/2048                    770830 ns      770820 ns      18162
BM_WheelSieve30Bitset/4096                   1606450 ns     1606429 ns       8703
BM_WheelSieve30Bitset/8192                   3386453 ns     3386407 ns       4131
BM_WheelSieve30Bitset/16384                  7427380 ns     7427287 ns       1884
BM_WheelSieve30Bitset/32768                 15876733 ns    15876486 ns        882
BM_WheelSieve30Bitset/65536                 33285839 ns    33285415 ns        420
BM_WheelSieve30Bitset/131072                69308301 ns    69307340 ns        202
BM_WheelSieve30Bitset/262144               192787857 ns   192784707 ns         72
BM_WheelSieve30Bitset/524288               606356428 ns   606346015 ns         23
BM_WheelSieve30Bitset/1048576             1430653078 ns  1430629443 ns         10
BM_WheelSieve30Bitset/2097152             3095184529 ns  3095142866 ns          5
BM_WheelSieve30Bitset/4194304             6594669200 ns  6594583550 ns          2
BM_WheelSieve30Bitset/8388608            13925300726 ns 13925089525 ns          1
BM_WheelSieve30Bitset/16777216           29094395291 ns 29094009228 ns          1
BM_WheelSieve210Bitset/1                         229 ns         229 ns   61162332
BM_WheelSieve210Bitset/2                         492 ns         492 ns   28476427
BM_WheelSieve210Bitset/4                        1170 ns        1170 ns   11955373
BM_WheelSieve210Bitset/8                        2616 ns        2616 ns    5342331
BM_WheelSieve210Bitset/16                       5749 ns        5749 ns    2435990
BM_WheelSieve210Bitset/32                      12716 ns       12716 ns    1099816
BM_WheelSieve210Bitset/64                      27624 ns       27624 ns     507138
BM_WheelSieve210Bitset/128                     59529 ns       59528 ns     235244
BM_WheelSieve210Bitset/256                    127255 ns      127254 ns     109821
BM_WheelSieve210Bitset/512                    269680 ns      269677 ns      51931
BM_WheelSieve210Bitset/1024                   569716 ns      569709 ns      24490
BM_WheelSieve210Bitset/2048                  1206615 ns     1206601 ns      11589
BM_WheelSieve210Bitset/4096                  2535062 ns     2535030 ns       5524
BM_WheelSieve210Bitset/8192                  5295335 ns     5295267 ns       2644
BM_WheelSieve210Bitset/16384                11044517 ns    11044394 ns       1268
BM_WheelSieve210Bitset/32768                22953145 ns    22952878 ns        609
BM_WheelSieve210Bitset/65536                47577765 ns    47577180 ns        294
BM_WheelSieve210Bitset/131072               98339188 ns    98338029 ns        142
BM_WheelSieve210Bitset/262144              215286122 ns   215283282 ns         65
BM_WheelSieve210Bitset/524288              708463006 ns   708453012 ns         20
BM_WheelSieve210Bitset/1048576            1624367940 ns  1624347561 ns          9
BM_WheelSieve210Bitset/2097152            3516782413 ns  3516737517 ns          4
BM_WheelSieve210Bitset/4194304            7505799721 ns  7505694664 ns          2
BM_WheelSieve210Bitset/8388608           15845845649 ns 15845638194 ns          1
BM_WheelSieve210Bitset/16777216          33829388833 ns 33828979810 ns          1
BM_SegmentedWheelSieve6Bitset/1                  625 ns         625 ns   22388501
BM_SegmentedWheelSieve6Bitset/2                 1139 ns        1139 ns   12274402
BM_SegmentedWheelSieve6Bitset/4                 2154 ns        2154 ns    6511247
BM_SegmentedWheelSieve6Bitset/8                 4304 ns        4304 ns    3253216
BM_SegmentedWheelSieve6Bitset/16                8555 ns        8555 ns    1636974
BM_SegmentedWheelSieve6Bitset/32               17706 ns       17705 ns     790465
BM_SegmentedWheelSieve6Bitset/64               36018 ns       36018 ns     389003
BM_SegmentedWheelSieve6Bitset/128              74481 ns       74480 ns     187926
BM_SegmentedWheelSieve6Bitset/256             154285 ns      154283 ns      90772
BM_SegmentedWheelSieve6Bitset/512             324386 ns      324382 ns      43226
BM_SegmentedWheelSieve6Bitset/1024            692459 ns      692451 ns      20217
BM_SegmentedWheelSieve6Bitset/2048           1412167 ns     1412151 ns       9921
BM_SegmentedWheelSieve6Bitset/4096           2918474 ns     2918438 ns       4800
BM_SegmentedWheelSieve6Bitset/8192           5904096 ns     5904029 ns       2371
BM_SegmentedWheelSieve6Bitset/16384         12065061 ns    12064947 ns       1161
BM_SegmentedWheelSieve6Bitset/32768         24760315 ns    24760064 ns        566
BM_SegmentedWheelSieve6Bitset/65536         50309788 ns    50309312 ns        278
BM_SegmentedWheelSieve6Bitset/131072       102665128 ns   102663997 ns        136
BM_SegmentedWheelSieve6Bitset/262144       210100654 ns   210098232 ns         67
BM_SegmentedWheelSieve6Bitset/524288       430199492 ns   430195228 ns         33
BM_SegmentedWheelSieve6Bitset/1048576      879435993 ns   879426755 ns         16
BM_SegmentedWheelSieve6Bitset/2097152     1796518198 ns  1796499693 ns          8
BM_SegmentedWheelSieve6Bitset/4194304     3674112394 ns  3674075693 ns          4
BM_SegmentedWheelSieve6Bitset/8388608     7517055469 ns  7516971704 ns          2
BM_SegmentedWheelSieve6Bitset/16777216   15352052872 ns 15351885352 ns          1
BM_SegmentedWheelSieve30Bitset/1                 411 ns         411 ns   34108411
BM_SegmentedWheelSieve30Bitset/2                 748 ns         748 ns   18725879
BM_SegmentedWheelSieve30Bitset/4                1460 ns        1460 ns    9569268
BM_SegmentedWheelSieve30Bitset/8                2915 ns        2915 ns    4805836
BM_SegmentedWheelSieve30Bitset/16               5756 ns        5756 ns    2435346
BM_SegmentedWheelSieve30Bitset/32              11770 ns       11770 ns    1190525
BM_SegmentedWheelSieve30Bitset/64              24181 ns       24181 ns     579782
BM_SegmentedWheelSieve30Bitset/128             50027 ns       50026 ns     279804
BM_SegmentedWheelSieve30Bitset/256            104238 ns      104237 ns     134340
BM_SegmentedWheelSieve30Bitset/512            216306 ns      216304 ns      64633
BM_SegmentedWheelSieve30Bitset/1024           454692 ns      454688 ns      30765
BM_SegmentedWheelSieve30Bitset/2048           954339 ns      954330 ns      14670
BM_SegmentedWheelSieve30Bitset/4096          2006071 ns     2006049 ns       6982
BM_SegmentedWheelSieve30Bitset/8192          4064495 ns     4064454 ns       3446
BM_SegmentedWheelSieve30Bitset/16384         8368447 ns     8368350 ns       1675
BM_SegmentedWheelSieve30Bitset/32768        17194309 ns    17194144 ns        814
BM_SegmentedWheelSieve30Bitset/65536        35234035 ns    35233658 ns        398
BM_SegmentedWheelSieve30Bitset/131072       72241113 ns    72240348 ns        194
BM_SegmentedWheelSieve30Bitset/262144      148258218 ns   148256548 ns         94
BM_SegmentedWheelSieve30Bitset/524288      304431835 ns   304427795 ns         46
BM_SegmentedWheelSieve30Bitset/1048576     624811905 ns   624804790 ns         22
BM_SegmentedWheelSieve30Bitset/2097152    1282663452 ns  1282649307 ns         11
BM_SegmentedWheelSieve30Bitset/4194304    2634687733 ns  2634662910 ns          5
BM_SegmentedWheelSieve30Bitset/8388608    5405076319 ns  5405022991 ns          3
BM_SegmentedWheelSieve30Bitset/16777216  11085752044 ns 11085640444 ns          1
BM_SegmentedWheelSieve210Bitset/1                454 ns         454 ns   30859506
BM_SegmentedWheelSieve210Bitset/2                884 ns         884 ns   15835618
BM_SegmentedWheelSieve210Bitset/4               1942 ns        1942 ns    7276990
BM_SegmentedWheelSieve210Bitset/8               4047 ns        4046 ns    3458876
BM_SegmentedWheelSieve210Bitset/16              8472 ns        8471 ns    1652693
BM_SegmentedWheelSieve210Bitset/32             18021 ns       18019 ns     776251
BM_SegmentedWheelSieve210Bitset/64             37671 ns       37668 ns     371552
BM_SegmentedWheelSieve210Bitset/128            79698 ns       79690 ns     175684
BM_SegmentedWheelSieve210Bitset/256           168295 ns      168279 ns      83272
BM_SegmentedWheelSieve210Bitset/512           352830 ns      352797 ns      39652
BM_SegmentedWheelSieve210Bitset/1024          738998 ns      738930 ns      18957
BM_SegmentedWheelSieve210Bitset/2048         1536703 ns     1536552 ns       9116
BM_SegmentedWheelSieve210Bitset/4096         3149898 ns     3149614 ns       4453
BM_SegmentedWheelSieve210Bitset/8192         6241391 ns     6240836 ns       2248
BM_SegmentedWheelSieve210Bitset/16384       12603141 ns    12602007 ns       1113
BM_SegmentedWheelSieve210Bitset/32768       25756278 ns    25753983 ns        544
BM_SegmentedWheelSieve210Bitset/65536       52893138 ns    52888519 ns        265
BM_SegmentedWheelSieve210Bitset/131072     108773480 ns   108763995 ns        129
BM_SegmentedWheelSieve210Bitset/262144     223651175 ns   223631728 ns         63
BM_SegmentedWheelSieve210Bitset/524288     471292960 ns   471251442 ns         30
BM_SegmentedWheelSieve210Bitset/1048576    945704545 ns   945624525 ns         15
BM_SegmentedWheelSieve210Bitset/2097152   1944532293 ns  1944375601 ns          7
BM_SegmentedWheelSieve210Bitset/4194304   4014485076 ns  4014140418 ns          3
BM_SegmentedWheelSieve210Bitset/8388608   8324732704 ns  8324041008 ns          2
BM_SegmentedWheelSieve210Bitset/16777216 17303931443 ns 17302447865 ns          1
</pre>
